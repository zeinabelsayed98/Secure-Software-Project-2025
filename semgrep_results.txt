                    
                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 16 Code Findings â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                
  [36m[22m[24m  src/router/routes/frontend.js[0m
    â¯â± [1mjavascript.express.security.express-insecure-template-usage.express-insecure-template-usage[0m
          User data from `req` is being compiled into the template, which can lead to a Server Side Template
          Injection (SSTI) vulnerability.                                                                   
          Details: https://sg.run/b49v                                                                      
                                                                                                            
           17â”† rendered = nunjucks.renderString(message);
            â‹®â”†----------------------------------------
           40â”† rendered = nunjucks.renderString(message);
                                             
  [36m[22m[24m  src/router/routes/order.js[0m
    â¯â± [1mjavascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal[0m
          Possible writing outside of the destination, make sure that the target path is nested in the
          intended destination                                                                        
          Details: https://sg.run/weRn                                                                
                                                                                                      
           33â”† fs.readFile(path.join(__dirname, filePath),function(err,data){
   
   â¯â¯â± [1mjavascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection[0m
          Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if   
          the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it
          is recommended to use parameterized queries or prepared statements.                                 
          Details: https://sg.run/gjoe                                                                        
                                                                                                              
           67â”† const beers = db.sequelize.query(sql, { type: 'RAW' }).then(beers => {
                                              
  [36m[22m[24m  src/router/routes/system.js[0m
    â¯â± [1mjavascript.express.security.audit.xss.direct-response-write.direct-response-write[0m
          Detected directly writing to a Response object from user-defined input. This bypasses any HTML      
          escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use
          'resp.render()' to render safely escaped HTML.                                                      
          Details: https://sg.run/vzGl                                                                        
                                                                                                              
           18â”† res.send(test)
   
    â¯â± [1mjavascript.express.security.audit.express-open-redirect.express-open-redirect[0m
          The application redirects to a URL specified by user-supplied input `req` that is not validated.   
          This could redirect users to malicious locations. Consider using an allow-list approach to validate
          URLs, or warn users they are being redirected to a third-party website.                            
          Details: https://sg.run/EpoP                                                                       
                                                                                                             
           37â”† res.redirect(url);
   
    â¯â± [1mjavascript.express.security.audit.express-third-party-object-deserialization.express-third-party-object-[0m
  [1m     deserialization[0m                                                                                         
          The following function call serialize.unserialize accepts user controlled data which can result in
          Remote Code Execution (RCE) through Object Deserialization. It is recommended to use secure data  
          processing alternatives such as JSON.parse() and Buffer.from().                                   
          Details: https://sg.run/8W5j                                                                      
                                                                                                            
           64â”† var deser = serialize.unserialize(body)
                                            
  [36m[22m[24m  src/router/routes/user.js[0m
    â¯â± [1mjavascript.jsonwebtoken.security.jwt-hardcode.hardcoded-jwt-secret[0m
          A hard-coded credential was detected. It is not recommended to store credentials in source-code, as
          this risks secrets being leaked and used by either an internal or external malicious adversary. It 
          is recommended to use environment variables to securely provide credentials or retrieve credentials
          from a secure vault or HSM (Hardware Security Module).                                             
          Details: https://sg.run/4xN9                                                                       
                                                                                                             
           18â”† const user_object = jwt.verify(req.headers.authorization.split(' ')[1],"SuperSecret")
            â‹®â”†----------------------------------------
          253â”† var token = jwt.sign(payload, jwtTokenSecret, {
            â‹®â”†----------------------------------------
          406â”† var jwttoken = jwt.sign(payload, jwtTokenSecret, {
                                
  [36m[22m[24m  src/server.js[0m
    â¯â± [1mjavascript.express.security.audit.express-cookie-settings.express-cookie-session-no-domain[0m
          Default session middleware settings: `domain` not set. It indicates the domain of the cookie; use it
          to compare against the domain of the server in which the URL is being requested. If they match, then
          check the path attribute next.                                                                      
          Details: https://sg.run/rd41                                                                        
                                                                                                              
           43â”† app.use(session({
           44â”†   genid:function(req){
           45â”†     if ( (req.session) && (req.session.uid) ) {
           46â”†       return req.session.uid + "_" + 123;
           47â”†       //    return new Date().getTime().toString();
           48â”†
           49â”†     } else {
           50â”†       return new Date().getTime().toString();
           51â”†     }
           52â”†   },
             [hid 9 additional lines, adjust with --max-lines-per-finding] 
   
    â¯â± [1mjavascript.express.security.audit.express-cookie-settings.express-cookie-session-no-expires[0m
          Default session middleware settings: `expires` not set. Use it to set expiration date for persistent
          cookies.                                                                                            
          Details: https://sg.run/N4eG                                                                        
                                                                                                              
           43â”† app.use(session({
           44â”†   genid:function(req){
           45â”†     if ( (req.session) && (req.session.uid) ) {
           46â”†       return req.session.uid + "_" + 123;
           47â”†       //    return new Date().getTime().toString();
           48â”†
           49â”†     } else {
           50â”†       return new Date().getTime().toString();
           51â”†     }
           52â”†   },
             [hid 9 additional lines, adjust with --max-lines-per-finding] 
   
    â¯â± [1mjavascript.express.security.audit.express-cookie-settings.express-cookie-session-no-httponly[0m
          Default session middleware settings: `httpOnly` not set. It ensures the cookie is sent only over
          HTTP(S), not client JavaScript, helping to protect against cross-site scripting attacks.        
          Details: https://sg.run/ydBO                                                                    
                                                                                                          
           43â”† app.use(session({
           44â”†   genid:function(req){
           45â”†     if ( (req.session) && (req.session.uid) ) {
           46â”†       return req.session.uid + "_" + 123;
           47â”†       //    return new Date().getTime().toString();
           48â”†
           49â”†     } else {
           50â”†       return new Date().getTime().toString();
           51â”†     }
           52â”†   },
             [hid 9 additional lines, adjust with --max-lines-per-finding] 
   
    â¯â± [1mjavascript.express.security.audit.express-cookie-settings.express-cookie-session-no-path[0m
          Default session middleware settings: `path` not set. It indicates the path of the cookie; use it to
          compare against the request path. If this and domain match, then send the cookie in the request.   
          Details: https://sg.run/b7pd                                                                       
                                                                                                             
           43â”† app.use(session({
           44â”†   genid:function(req){
           45â”†     if ( (req.session) && (req.session.uid) ) {
           46â”†       return req.session.uid + "_" + 123;
           47â”†       //    return new Date().getTime().toString();
           48â”†
           49â”†     } else {
           50â”†       return new Date().getTime().toString();
           51â”†     }
           52â”†   },
             [hid 9 additional lines, adjust with --max-lines-per-finding] 
   
    â¯â± [1mjavascript.express.security.audit.express-cookie-settings.express-cookie-session-no-secure[0m
          Default session middleware settings: `secure` not set. It ensures the browser only sends the cookie
          over HTTPS.                                                                                        
          Details: https://sg.run/9oKz                                                                       
                                                                                                             
           43â”† app.use(session({
           44â”†   genid:function(req){
           45â”†     if ( (req.session) && (req.session.uid) ) {
           46â”†       return req.session.uid + "_" + 123;
           47â”†       //    return new Date().getTime().toString();
           48â”†
           49â”†     } else {
           50â”†       return new Date().getTime().toString();
           51â”†     }
           52â”†   },
             [hid 9 additional lines, adjust with --max-lines-per-finding] 
   
    â¯â± [1mjavascript.express.security.audit.express-session-hardcoded-secret.express-session-hardcoded-secret[0m
          A hard-coded credential was detected. It is not recommended to store credentials in source-code, as
          this risks secrets being leaked and used by either an internal or external malicious adversary. It 
          is recommended to use environment variables to securely provide credentials or retrieve credentials
          from a secure vault or HSM (Hardware Security Module).                                             
          Details: https://sg.run/LYvG                                                                       
                                                                                                             
           57â”† secret: 'SuperSecret',
